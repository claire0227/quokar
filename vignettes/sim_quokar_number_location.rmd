##Simulation Study
###Number and Location

```{r}
x <- sort(runif(100))
y1 <- 40*x + x*rnorm(100, 0, 10)

selectedX <- sample(50:100,5)
y2 <- y1
y2[selectedX] <- x[1:5]*rnorm(5, 0, 10)

y3 <- y2
y3[selectedX] <- y3[selectedX] - 5

y4 <- y3
y4[selectedX] <- y4[selectedX] - 5

df <- data.frame(x, y1, y2, y3, y4)

df.qr1 <- coef(rq(y1~x, data=df, seq(0.1,0.9,0.1)))
p1 <- ggplot(data=df) + ylim(c(-10, 50))+geom_point(aes(x=x, y=y1),
                                                    alpha=0.1) +
    geom_abline(intercept=df.qr1[1,1], slope=df.qr1[2,1],
                colour="red") +
        geom_abline(intercept=df.qr1[1,2], slope=df.qr1[2,2],
                colour="orange") +
        geom_abline(intercept=df.qr1[1,3], slope=df.qr1[2,3]) +
        geom_abline(intercept=df.qr1[1,4], slope=df.qr1[2,4]) +
        geom_abline(intercept=df.qr1[1,5], slope=df.qr1[2,5]) +
        geom_abline(intercept=df.qr1[1,6], slope=df.qr1[2,6]) +
        geom_abline(intercept=df.qr1[1,7], slope=df.qr1[2,7]) +
        geom_abline(intercept=df.qr1[1,8], slope=df.qr1[2,8]) +
        geom_abline(intercept=df.qr1[1,9], slope=df.qr1[2,9])

df.qr2 <- coef(rq(y2~x, data=df, seq(0.1, 0.9, 0.1)))
p2 <- ggplot(data=df) + ylim(c(-10, 50))+ geom_point(aes(x=x, y=y2),              alpha=0.1) +
        geom_abline(intercept=df.qr2[1,1], slope=df.qr2[2,1],
                colour="red") +
        geom_abline(intercept=df.qr2[1,2], slope=df.qr2[2,2],
                colour="orange") +
        geom_abline(intercept=df.qr2[1,3], slope=df.qr2[2,3]) +
        geom_abline(intercept=df.qr2[1,4], slope=df.qr2[2,4]) +
        geom_abline(intercept=df.qr2[1,5], slope=df.qr2[2,5]) +
        geom_abline(intercept=df.qr2[1,6], slope=df.qr2[2,6]) +
        geom_abline(intercept=df.qr2[1,7], slope=df.qr2[2,7]) +
        geom_abline(intercept=df.qr2[1,8], slope=df.qr2[2,8]) +
        geom_abline(intercept=df.qr2[1,9], slope=df.qr2[2,9])

df.qr3 <- coef(rq(y3~x, data=df, seq(0.1, 0.9, 0.1)))
p3 <- ggplot(data=df)+ ylim(c(-10, 50)) + geom_point(aes(x=x, y=y3),              alpha=0.1) +
        geom_abline(intercept=df.qr3[1,1], slope=df.qr3[2,1],
                colour="red") +
        geom_abline(intercept=df.qr3[1,2], slope=df.qr3[2,2],
                colour="orange") +
        geom_abline(intercept=df.qr3[1,3], slope=df.qr3[2,3]) +
        geom_abline(intercept=df.qr3[1,4], slope=df.qr3[2,4]) +
        geom_abline(intercept=df.qr3[1,5], slope=df.qr3[2,5]) +
        geom_abline(intercept=df.qr3[1,6], slope=df.qr3[2,6]) +
        geom_abline(intercept=df.qr3[1,7], slope=df.qr3[2,7]) +
        geom_abline(intercept=df.qr3[1,8], slope=df.qr3[2,8]) +
        geom_abline(intercept=df.qr3[1,9], slope=df.qr3[2,9])

df.qr4 <- coef(rq(y4~x, data=df, seq(0.1, 0.9, 0.1)))
p4 <- ggplot(data=df) + ylim(c(-10, 50))+ geom_point(aes(x=x, y=y4),              alpha=0.1) +
        geom_abline(intercept=df.qr4[1,1], slope=df.qr4[2,1],
                colour="red") +
        geom_abline(intercept=df.qr4[1,2], slope=df.qr4[2,2],
                colour="orange") +
        geom_abline(intercept=df.qr4[1,3], slope=df.qr4[2,3],
                colour ="purple") +
        geom_abline(intercept=df.qr4[1,4], slope=df.qr4[2,4]) +
        geom_abline(intercept=df.qr4[1,5], slope=df.qr4[2,5]) +
        geom_abline(intercept=df.qr4[1,6], slope=df.qr4[2,6]) +
        geom_abline(intercept=df.qr4[1,7], slope=df.qr4[2,7]) +
        geom_abline(intercept=df.qr4[1,8], slope=df.qr4[2,8]) +
        geom_abline(intercept=df.qr4[1,9], slope=df.qr4[2,9])

grid.arrange(p1, p2, p3,p4, ncol = 2)

```

```{r}

x <- sort(runif(100))
y1 <- 40*x + x*rnorm(100, 0, 10)

selectedX <- sample(50:100,10)
y2 <- y1
y2[selectedX] <- x[1:10]*rnorm(5, 0, 10)

selectedX <- sample(50:100, 10)
y3 <- y2
y3[selectedX] <- y3[selectedX] - 5

y4 <- y3
y4[selectedX] <- y4[selectedX] - 5

df <- data.frame(x, y1, y2, y3, y4)

df.qr1 <- coef(rq(y1~x, data=df, seq(0.1,0.9,0.1)))
p1 <- ggplot(data=df))+geom_point(aes(x=x, y=y1), alpha=0.1) +
    geom_abline(intercept=df.qr1[1,1], slope=df.qr1[2,1],
                colour="red") +
        geom_abline(intercept=df.qr1[1,2], slope=df.qr1[2,2],
                colour="orange") +
        geom_abline(intercept=df.qr1[1,3], slope=df.qr1[2,3]) +
        geom_abline(intercept=df.qr1[1,4], slope=df.qr1[2,4]) +
        geom_abline(intercept=df.qr1[1,5], slope=df.qr1[2,5]) +
        geom_abline(intercept=df.qr1[1,6], slope=df.qr1[2,6]) +
        geom_abline(intercept=df.qr1[1,7], slope=df.qr1[2,7]) +
        geom_abline(intercept=df.qr1[1,8], slope=df.qr1[2,8]) +
        geom_abline(intercept=df.qr1[1,9], slope=df.qr1[2,9])

df.qr2 <- coef(rq(y2~x, data=df, seq(0.1, 0.9, 0.1)))
p2 <- ggplot(data=df) + geom_point(aes(x=x, y=y2), alpha=0.1) +
        geom_abline(intercept=df.qr2[1,1], slope=df.qr2[2,1],
                colour="red") +
        geom_abline(intercept=df.qr2[1,2], slope=df.qr2[2,2],
                colour="orange") +
        geom_abline(intercept=df.qr2[1,3], slope=df.qr2[2,3]) +
        geom_abline(intercept=df.qr2[1,4], slope=df.qr2[2,4]) +
        geom_abline(intercept=df.qr2[1,5], slope=df.qr2[2,5]) +
        geom_abline(intercept=df.qr2[1,6], slope=df.qr2[2,6]) +
        geom_abline(intercept=df.qr2[1,7], slope=df.qr2[2,7]) +
        geom_abline(intercept=df.qr2[1,8], slope=df.qr2[2,8]) +
        geom_abline(intercept=df.qr2[1,9], slope=df.qr2[2,9])

df.qr3 <- coef(rq(y3~x, data=df, seq(0.1, 0.9, 0.1)))
p3 <- ggplot(data=df) + geom_point(aes(x=x, y=y3), alpha=0.1) +
        geom_abline(intercept=df.qr3[1,1], slope=df.qr3[2,1],
                colour="red") +
        geom_abline(intercept=df.qr3[1,2], slope=df.qr3[2,2],
                colour="orange") +
        geom_abline(intercept=df.qr3[1,3], slope=df.qr3[2,3]) +
        geom_abline(intercept=df.qr3[1,4], slope=df.qr3[2,4]) +
        geom_abline(intercept=df.qr3[1,5], slope=df.qr3[2,5]) +
        geom_abline(intercept=df.qr3[1,6], slope=df.qr3[2,6]) +
        geom_abline(intercept=df.qr3[1,7], slope=df.qr3[2,7]) +
        geom_abline(intercept=df.qr3[1,8], slope=df.qr3[2,8]) +
        geom_abline(intercept=df.qr3[1,9], slope=df.qr3[2,9])

df.qr4 <- coef(rq(y4~x, data=df, seq(0.1, 0.9, 0.1)))
p4 <- ggplot(data=df) + geom_point(aes(x=x, y=y4), alpha=0.1) +
        geom_abline(intercept=df.qr4[1,1], slope=df.qr4[2,1],
                colour="red") +
        geom_abline(intercept=df.qr4[1,2], slope=df.qr4[2,2],
                colour="orange") +
        geom_abline(intercept=df.qr4[1,3], slope=df.qr4[2,3],
                colour ="purple") +
        geom_abline(intercept=df.qr4[1,4], slope=df.qr4[2,4]) +
        geom_abline(intercept=df.qr4[1,5], slope=df.qr4[2,5]) +
        geom_abline(intercept=df.qr4[1,6], slope=df.qr4[2,6]) +
        geom_abline(intercept=df.qr4[1,7], slope=df.qr4[2,7]) +
        geom_abline(intercept=df.qr4[1,8], slope=df.qr4[2,8]) +
        geom_abline(intercept=df.qr4[1,9], slope=df.qr4[2,9])

grid.arrange(p1, p2, p3,p4, ncol = 2)

```
